const router = require('express').Router()
const postCtrl = require('../controllers/postCtrl')
const auth = require('../middleware/auth')

// ==================== RUTAS PÃšBLICAS ====================

// ğŸ“Œ OBTENER TODOS LOS POSTS (con filtros)
router.route('/posts')
    .get(postCtrl.getPosts);        // GET /api/posts

// ğŸ“Œ OBTENER CATEGORÃAS PAGINADAS
router.get('/categories/paginated', postCtrl.getAllCategoriesPaginated);

// ğŸ“Œ POSTS POR CATEGORÃA
router.get('/category/:category', postCtrl.getPostsByCategory);

// ğŸ“Œ POSTS POR SUBCATEGORÃA
router.get('/category/:category/subcategory/:subcategory', postCtrl.getPostsBySubcategory);

// ğŸ“Œ SUBCATEGORÃAS DE UNA CATEGORÃA
router.get('/categories/:category/subcategories', postCtrl.getSubCategoriesByCategory);

// ğŸ“Œ POSTS SIMILARES
router.get('/posts/similar', postCtrl.getSimilarPosts);

// ğŸ“Œ POSTS POR OPERACIÃ“N INMOBILIARIA
router.get('/posts/category/immobilier/operation/:operationId', postCtrl.getPostsByImmobilierOperation);

// ğŸ“Œ OBTENER UN POST ESPECÃFICO
router.get('/post/:id', postCtrl.getPost);

// âœ… RUTAS DE BOUTIQUES - PÃšBLICAS
router.get('/boutiques', postCtrl.getBoutiques); // âœ… Obtener boutiques

// ==================== RUTAS PROTEGIDAS (AUTH) ====================

// ğŸ“Œ CREAR POST (producto normal o boutique)
router.post('/posts', auth, postCtrl.createPost);

// ğŸ“Œ ACTUALIZAR POST
router.patch('/post/:id', auth, postCtrl.updatePost);

// ğŸ“Œ ELIMINAR POST
router.delete('/post/:id', auth, postCtrl.deletePost);

// ğŸ“Œ POSTS DEL USUARIO
router.get('/user_posts/:id', auth, postCtrl.getUserPosts);

// ğŸ“Œ POSTS DESCUBRIR (following)
router.get('/post_discover', auth, postCtrl.getPostsDicover);

// ğŸ“Œ GUARDAR/QUITAR POST
router.patch('/savePost/:id', auth, postCtrl.savePost);
router.patch('/unSavePost/:id', auth, postCtrl.unSavePost);

// ğŸ“Œ POSTS GUARDADOS
router.get('/getSavePosts', auth, postCtrl.getSavePosts);

// âœ… RUTAS DE BOUTIQUES - PROTEGIDAS
router.patch('/boutiques/:boutiqueId/activate', auth, postCtrl.activateBoutique); // âœ… Activar boutique

// âœ… RUTA ALTERNATIVA PARA OBTENER POSTS POR CATEGORÃA
router.get('/posts/category/:category', postCtrl.getPostsByCategory);

module.exports = router;
 