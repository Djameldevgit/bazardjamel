import React from 'react';

// üìù Campos b√°sicos
import TitleField from './camposComun/TitleField';
import ReferenceField from './camposComun/ReferenceField';
import DescriptionField from './camposComun/DescriptionField';

// üè∑Ô∏è Campos de estado y caracter√≠sticas
import EtatField from './camposComun/EtatField';
import TailleField from './camposComun/TailleField';
import CouleurField from './camposComun/CouleurField';
import QuantiteField from './camposComun/QuantiteField';

// üí∞ Campos de precio y negociaci√≥n
import PriceField from './camposComun/PriceField';
import UnitePrixField from './camposComun/UnitePrixField';
import TypeOffreField from './camposComun/TypeOffreField';
import EchangeField from './camposComun/EchangeField';

// üìç Campos de localizaci√≥n
import WilayaField from './camposComun/WilayaField';
import CommuneField from './camposComun/CommuneField';
import AdresseField from './camposComun/AdresseField';

// üìû Campos de contacto
import TelephoneField from './camposComun/TelephoneField';
import EmailField from './camposComun/EmailField';

// üöö Campos de entrega
import LivraisonField from './camposComun/LivraisonField';

// üîß Funci√≥n para renderizar cualquier campo com√∫n
export const renderCommonField = (fieldName, props) => {
  const {
    postData = {},
    handleChangeInput,
    isRTL = false,
    t = (key, fallback) => fallback,
    mainCategory,
    subCategory,
    fieldConfig = {},
    wilayasData = [],
    communesList = [],
    selectedWilaya = null,
    onWilayaChange = null
  } = props;

  // Configuraci√≥n espec√≠fica del campo
  const config = {
    name: fieldConfig.name || fieldName,
    label: fieldConfig.label || getDefaultLabel(fieldName),
    required: fieldConfig.required || false,
    disabled: fieldConfig.disabled || false,
    ...fieldConfig
  };

  // Mapeo de campos a componentes
  const fieldComponents = {
    // üìù Campos b√°sicos
    'title': (
      <TitleField
        key="title"
        postData={postData}
        handleChangeInput={handleChangeInput}
        name={config.name}
        label={config.label}
        required={config.required}
        disabled={config.disabled}
      />
    ),
    
    'reference': (
      <ReferenceField
        key="reference"
        postData={postData}
        handleChangeInput={handleChangeInput}
        name={config.name}
        label={config.label}
        required={config.required}
        disabled={config.disabled}
      />
    ),
    
    'description': (
      <DescriptionField
        key="description"
        postData={postData}
        handleChangeInput={handleChangeInput}
        name={config.name}
        label={config.label}
        required={config.required}
        disabled={config.disabled}
        isRTL={isRTL}
        t={t}
      />
    ),
    
    // üè∑Ô∏è Campos de estado y caracter√≠sticas
    'etat': (
      <EtatField
        key="etat"
        postData={postData}
        handleChangeInput={handleChangeInput}
        name={config.name}
        label={config.label}
        required={config.required}
        disabled={config.disabled}
        isRTL={isRTL}
        t={t}
      />
    ),
    
    'taille': (
      <TailleField
        key="taille"
        postData={postData}
        handleChangeInput={handleChangeInput}
        name={config.name}
        label={config.label}
        required={config.required}
        disabled={config.disabled}
        isRTL={isRTL}
        t={t}
      />
    ),
    
    'couleur': (
      <CouleurField
        key="couleur"
        mainCategory={mainCategory}
        subCategory={subCategory}
        postData={postData}
        handleChangeInput={handleChangeInput}
        name={config.name}
        label={config.label}
        required={config.required}
        disabled={config.disabled}
        isRTL={isRTL}
        t={t}
      />
    ),
    
    'quantite': (
      <QuantiteField
        key="quantite"
        postData={postData}
        handleChangeInput={handleChangeInput}
        name={config.name}
        label={config.label}
        required={config.required}
        disabled={config.disabled}
      />
    ),
    
    // üí∞ Campos de precio y negociaci√≥n
    'prix': (
      <PriceField
        key="prix"
        postData={postData}
        handleChangeInput={handleChangeInput}
        name={config.name}
        label={config.label}
        required={config.required}
        disabled={config.disabled}
      />
    ),
    
    'unitePrix': (
      <UnitePrixField
        key="unitePrix"
        postData={postData}
        handleChangeInput={handleChangeInput}
        name={config.name}
        label={config.label}
        required={config.required}
        disabled={config.disabled}
      />
    ),
    
    'typeOffre': (
      <TypeOffreField
        key="typeOffre"
        postData={postData}
        handleChangeInput={handleChangeInput}
        name={config.name}
        label={config.label}
        required={config.required}
        disabled={config.disabled}
      />
    ),
    
    'echange': (
      <EchangeField
        key="echange"
        postData={postData}
        handleChangeInput={handleChangeInput}
        name={config.name}
        label={config.label}
        required={config.required}
        disabled={config.disabled}
      />
    ),
    
    // üìç Campos de localizaci√≥n
    'wilaya': (
      <WilayaField
        key="wilaya"
        postData={postData}
        handleChangeInput={handleChangeInput}
        name={config.name}
        label={config.label}
        required={config.required}
        disabled={config.disabled}
        onWilayaChange={onWilayaChange}
        wilayasData={wilayasData}
      />
    ),
    
    'commune': (
      <CommuneField
        key="commune"
        postData={postData}
        handleChangeInput={handleChangeInput}
        name={config.name}
        label={config.label}
        required={config.required}
        disabled={config.disabled}
        communes={communesList}
        wilayaSelected={selectedWilaya}
      />
    ),
    
    'adresse': (
      <AdresseField
        key="adresse"
        postData={postData}
        handleChangeInput={handleChangeInput}
        name={config.name}
        label={config.label}
        required={config.required}
        disabled={config.disabled}
        isRTL={isRTL}
        t={t}
      />
    ),
    
    // üìû Campos de contacto
    'telephone': (
      <TelephoneField
        key="telephone"
        postData={postData}
        handleChangeInput={handleChangeInput}
        name={config.name}
        label={config.label}
        required={config.required}
        disabled={config.disabled}
        isRTL={isRTL}
        t={t}
      />
    ),
    
    'email': (
      <EmailField
        key="email"
        postData={postData}
        handleChangeInput={handleChangeInput}
        name={config.name}
        label={config.label}
        required={config.required}
        disabled={config.disabled}
        isRTL={isRTL}
        t={t}
      />
    ),
    
    // üöö Campos de entrega
    'livraison': (
      <LivraisonField
        key="livraison"
        postData={postData}
        handleChangeInput={handleChangeInput}
        name={config.name}
        label={config.label}
        required={config.required}
        disabled={config.disabled}
        isRTL={isRTL}
        t={t}
      />
    )
  };

  const FieldComponent = fieldComponents[fieldName];
  
  if (!FieldComponent) {
    console.warn(`‚ö†Ô∏è Campo com√∫n "${fieldName}" no encontrado en camposComunField`);
    
    // Campo gen√©rico como fallback
    return (
      <div className="mb-3">
        <label>{config.label} {config.required && '*'}</label>
        <input
          type="text"
          name={config.name}
          value={postData[config.name] || ''}
          onChange={handleChangeInput}
          required={config.required}
          disabled={config.disabled}
          className="form-control"
          placeholder={`Entrez ${config.label.toLowerCase()}`}
          dir={isRTL ? 'rtl' : 'ltr'}
        />
      </div>
    );
  }

  return FieldComponent;
};

// üîß Funci√≥n para obtener etiquetas por defecto en franc√©s
const getDefaultLabel = (fieldName) => {
  const labels = {
    'title': 'üìù Titre',
    'reference': 'üè∑Ô∏è R√©f√©rence',
    'description': 'üìÑ Description',
    'etat': 'üîß √âtat',
    'taille': 'üìè Taille',
    'couleur': 'üé® Couleur',
    'quantite': 'üì¶ Quantit√©',
    'prix': 'üí∞ Prix',
    'unitePrix': 'üíµ Unit√© de prix',
    'typeOffre': 'üè∑Ô∏è Type d\'offre',
    'echange': 'üîÑ √âchange',
    'wilaya': 'üìç Wilaya',
    'commune': 'üèòÔ∏è Commune',
    'adresse': 'üè† Adresse',
    'telephone': 'üìû T√©l√©phone',
    'email': 'üìß Email',
    'livraison': 'üöö Livraison'
  };
  
  return labels[fieldName] || fieldName;
};

// üìã Lista de todos los campos comunes disponibles
export const ALL_COMMON_FIELDS = [
  'title',
  'reference',
  'description',
  'etat',
  'taille',
  'couleur',
  'quantite',
  'prix',
  'unitePrix',
  'typeOffre',
  'echange',
  'wilaya',
  'commune',
  'adresse',
  'telephone',
  'email',
  'livraison'
];

// üéØ Campos requeridos por defecto
export const REQUIRED_COMMON_FIELDS = [
  'title',
  'description',
  'etat',
  'prix',
  'wilaya',
  'commune',
  'telephone'
];

// üìä Campos agrupados por categor√≠a
export const GROUPED_COMMON_FIELDS = {
  'informations': ['title', 'reference', 'description'],
  'caracteristiques': ['etat', 'taille', 'couleur', 'quantite'],
  'prix': ['prix', 'unitePrix', 'typeOffre', 'echange'],
  'localisation': ['wilaya', 'commune', 'adresse'],
  'contact': ['telephone', 'email'],
  'livraison': ['livraison']
};

// üîÑ Funci√≥n para renderizar m√∫ltiples campos comunes
export const renderMultipleCommonFields = (fieldNames, props) => {
  return fieldNames.map(fieldName => (
    <div key={fieldName} className="mb-3">
      {renderCommonField(fieldName, props)}
    </div>
  ));
};

// üèóÔ∏è Componente wrapper para campos comunes
const CamposComunField = ({ fieldName, ...props }) => {
  return renderCommonField(fieldName, props);
};

export default CamposComunField;