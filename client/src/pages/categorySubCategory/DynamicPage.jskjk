// src/pages/DynamicPage.js - VERSIÃ“N CORREGIDA
import React from 'react';
import { useParams, useHistory } from 'react-router-dom';

// âœ… IMPORTACIONES CORREGIDAS segÃºn tu estructura REAL
import CategoryPage from './categorySubCategory/CategoryPage';
import SubcategoryPage from './categorySubCategory/SubcategoryPage';
import PostId from './PostId';  // Ya tienes esto
import StoreList from './store/StoreList';  // âœ… Nombre REAL
import StoreDetail from './store/StoreDetail';  // O Store.js, verifica

// âœ… Importar desde components
 
const DynamicPage = () => {
  const { slug, page = "1" } = useParams();
  const history = useHistory();
  
  // ğŸ›‘ Si no hay slug, redirigir
  if (!slug) {
    history.push('/');
    return null;
  }
  
  // ğŸ¯ DETECTAR TIPO DE RUTA
  
  // 1. ES LISTADO DE TIENDAS
  if (slug === 'boutiques') {
    return <StoreList page={parseInt(page)} />;  // Usa tu componente existente
  }
  
  // 2. ES TIENDA INDIVIDUAL
  if (slug.startsWith('boutique-')) {
    const boutiqueSlug = slug.replace('boutique-', '');
    
    // Si tu StoreDetail acepta slug, pasarlo
    // Si no, redirigir a la versiÃ³n por ID (temporal)
    return <StoreDetail storeSlug={boutiqueSlug} />;
  }
  
  // 3. ES ANUNCIO INDIVIDUAL
  if (slug.startsWith('annonce-')) {
    const annonceId = slug.replace('annonce-', '').split('-')[0];
    return <PostId id={annonceId} />;
  }
  
  // 4. ES CATEGORÃA O SUBCATEGORÃA
  const parts = slug.split('-');
  
  if (parts.length === 1) {
    // ğŸ“‚ CATEGORÃA PRINCIPAL
    return <CategoryPage categoryName={parts[0]} page={page} />;
  } else {
    // ğŸ“‚ SUBCATEGORÃA
    return (
      <SubcategoryPage 
        categoryName={parts[0]} 
        subcategoryId={parts.slice(1).join('-')} 
        page={page}
      />
    );
  }
};

export default DynamicPage;